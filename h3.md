# h3 - No strings attached
### The goal of this homework is to practice static analysis by extracting hidden information from binaries using tools like strings, learning how passwords can be exposed and how simple obfuscation can hide them.
Obfuscation = making something hard to understand on purpose.



I started by installing all the necessary tools (ghidra for the next lesson): 
`sudo apt update`
`sudo apt install build-essential binutils ghd ghidra strings`

`build-essential` --> let us compile C code
`binutils` --> provides tools for analyzing binaries, including strings.
`strings` --> extracts readable text from binaries (main tool of the homework)
`gbd` --> allows to debug programs while they run (useful when static analysis is not enough)
`ghidra` --> helps disassemble binaries to undesrtand how they work internally.

disassemble = translating machine code (binary) into human readable assebly language. (often used for debugging).


 `sudo apt update`
<br><br>
<img width="700" height="464" alt="Screenshot 2026-02-01 at 8 36 11" src="https://github.com/user-attachments/assets/ee207c7b-c79e-4763-a9f0-1665490b13fb" />


<br><br>
`sudo apt install build-essential binutils`:
<br><br>


<img width="693" height="421" alt="Screenshot 2026-02-01 at 8 44 37" src="https://github.com/user-attachments/assets/138f7378-f2ab-447a-9608-d69ad4d9fb28" />

<br><br>


To verify everything worked: 
<br><br>



<img width="696" height="416" alt="Screenshot 2026-02-01 at 8 48 09" src="https://github.com/user-attachments/assets/0a64e601-0112-4153-b54a-962a7507e55b" />
<br><br>

sudo apt install gdb:

<img width="375" height="64" alt="Screenshot 2026-02-01 at 8 51 24" src="https://github.com/user-attachments/assets/4b0188f5-512a-4529-914e-a660bc98de3b" />
<br><br>
To install Ghidra properly, I first installed java (required for ghidra)
<br><br>
`sudo apt install openjdk-17-jdk` (this did not work) so i tried `sudo apt install default-jdk`:
<br><br>
<img width="468" height="110" alt="Screenshot 2026-02-01 at 8 58 12" src="https://github.com/user-attachments/assets/697d4178-a0cd-4fd6-98da-849c3a8c3cba" />
<br><br>
Then I installed ghidra (after many failed attemps i found the latest ghidra release)  
wget https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_12.0.1_build/ghidra_12.0.1_PUBLIC_20260114.zip (command)


https://github.com/NationalSecurityAgency/ghidra/releases/tag/Ghidra_12.0.2_build 
(the newest release)
<br><br>
Then I unziped the file by using command `unzip ghidra_12.0.2_PUBLIC_20260129.zip`
<br><br>

<img width="471" height="46" alt="Screenshot 2026-02-01 at 10 10 04" src="https://github.com/user-attachments/assets/0ad06a52-88a7-433c-abe7-907c9ddedb4d" />

<br><br>
I wanted to make sure Ghidra is really working --> `cd ghidra_12.0.2_PUBLIC` --> `ls` --> `./ghidraRun` and I a Ghidra GUI window opens:

<br><br>
<img width="1049" height="673" alt="Screenshot 2026-02-01 at 10 17 44" src="https://github.com/user-attachments/assets/07b3c877-293a-4dec-a699-d585f9d000fa" />

<br><br>

### a) Strings. Download exbin-challenges.zip. Run passtr. Find the correct password using 'strings'. Also find the flag.

I started by downloading `ezbin-challenges.zip` from terokarvinen.com/application-hacking/ and after that I unzipped the file by using command --> `unzip ezbin-challenges.zip`
<br><br>
BUT before that I moved the file to my home folder --> `mv ezbin-challenges.zip ~ `
<br><br>
<img width="695" height="335" alt="Screenshot 2026-02-01 at 10 35 21" src="https://github.com/user-attachments/assets/7ac77fc1-1cd0-4493-ae66-83d5ff226f56" />
<br><br>
Run `'passtr'` --> `cd challenges/passtr` --> `./passtr` and this showed up:
<br><br>
<img width="564" height="148" alt="Screenshot 2026-02-01 at 10 44 20" src="https://github.com/user-attachments/assets/b9325680-6043-4a41-bbc2-b44dbccd9108" />
<br><br>
<img width="559" height="74" alt="Screenshot 2026-02-01 at 10 57 31" src="https://github.com/user-attachments/assets/ae3709e2-9b1b-4d12-93f5-134b438b43f1" />
<br><br>
Then this happend...mac book problems. I confirmed the architecture and saw aarch64. This binary was complied for x85-64, but my Debian VM runs on ARM (aarch64) so it cannot be executed:

<br><br>
<img width="696" height="177" alt="Screenshot 2026-02-01 at 11 00 20" src="https://github.com/user-attachments/assets/009bfd9e-88d9-499d-aeb0-09a7f44858e0" />

<br><br>
After some googeling i found out that strings doe not require execution so even though `./passtr` command fails, I can still analyze it. I gave it a new try!
<br><br>
`strings passtr | less`
`/pass`
`/flag`

<br><br>
<img width="694" height="419" alt="Screenshot 2026-02-01 at 11 10 14" src="https://github.com/user-attachments/assets/1551cff0-1005-4f7c-a96b-92614c7d0eca" />
<br><br>
I noticed that there is a flag and above it a password called sala-hakkeri-321 and realized that that was the correct password. 
The binary could not be executed due to architecture mismatch (x86â€‘64 vs ARM).
<br><br>
Later i tried on windows computer: 
<br><br>
<img width="533" height="365" alt="Screenshot 2026-02-01 at 14 34 26" src="https://github.com/user-attachments/assets/6bd587de-aefb-4e2f-b285-2b47516d482a" />
<br><br>
And it worked indeed!

### b)  Make a new version of the passtr.c program where the password doesn't appear directly as-is in the binary. Demonstrate with a test that the password doesn't appear.

- The goal was to change the program so that the password is not stored in plain text in the compiled binary, but the program still works correctly.

- I started by opening the source code of the program. I was located in /Downloads/challenges/passtr. Aftre that i opened `nano passtr.c`

<br><br>

<img width="533" height="362" alt="Screenshot 2026-02-01 at 14 35 09" src="https://github.com/user-attachments/assets/c3ccda98-feba-43b9-b57b-04d5a7be2c62" />


<br><br>
The password is hard-coded in the source. We must change the source to hide it. 

<br><br>



I used XOR encryption method to obfuscate the password in the source code: This function XORs each character of the password with a key (0xAA). This makes the password unreadable in its source form. 
<br><br>
#include <stdio.h> 

#include <string.h> 

 

int main() { 

    char password[20]; 

    char obfuscated[] = {115, 97, 108, 97, 45, 104, 97, 107, 107, 101, 114, 105, 45, 51, 50, 49}; // ASCII values of "sala-hakkeri-321" 

    char decodedPassword[20]; 

    int i; 

 

    // Rebuild the password from the obfuscated array 

    for (i = 0; i < 16; i++) { 

        decodedPassword[i] = obfuscated[i]; 

    } 

    decodedPassword[16] = '\0';  // Null-terminate the string 

 

    printf("What's the password?\n"); 

    scanf("%19s", password); 

 

    if (0 == strcmp(password, decodedPassword)) { 

        printf("Yes! That's the password. FLAG{Tero-d75ee66af0a68663f15}\n"); 

    } else { 

        printf("Sorry, no bonus.\n"); 

    } 

    return 0; 

} 

<br><br>
<img width="535" height="347" alt="Screenshot 2026-02-01 at 14 38 38" src="https://github.com/user-attachments/assets/dbb385e9-43f6-4b4f-a7d8-f4cd7dc4b6ea" />
<br><br>


I saved changed in nano and complied it using `gcc passtr.c -o passtr`

<br><br>
To make sure that the password is not vissible anymore i ran `strings passtr`

<br><br>


<img width="531" height="380" alt="Screenshot 2026-02-01 at 14 41 15" src="https://github.com/user-attachments/assets/1d85ba9b-7cb3-487d-8da6-6f634822a403" />

<br><br>


### c) Packd. Run 'packd' from the package ezbin-challenges.zip. What is the password? What is the flag? (This task is slightly more challenging. Write down the approaches you tried and hypotheses you came up with. Hopefully you'll reach the goal yourself, but if not, the walkthrough will be revealed in class...)

I started by running the following command 
`strings packs`
to see if there is any readable text in the file.
<br><br>
I saw that the file was comressed/hidden.
<br><br>
I noticed wUPX insdie the binery.
`strings packd | grep -i upx.` 
After a long time of reading and searching for different ways to find a solution i read about UPX packer that is a tool that compresses programs. 
<br><br>
I installed UPX by running:
`sudo apt install upx` (with this tool I can unpack the program).
<br><br>
After installing UPX i unpacked the binary by running:
`upx -d packd`
This command removes the UPX compression and restores the original program.
<br><br>
I run
`strings packd`
(this checks the unpacked program for readable text again).
<br><br>
I can now see 
`what's the password? `
`piilos -An`
<br><br>
I continued by running the program: 
`./packd`
<br><br>
The program asked for a password, when I entered a guess it said: 
`sorry no bonus`
<br><br>
I went few steps back, tried again all the steps, run some commands in between and tried again:
`upx -d packd`
<br><br>
<img width="542" height="170" alt="Screenshot 2026-02-01 at 15 02 07" src="https://github.com/user-attachments/assets/52a2acd0-9ebc-49b6-a80d-e95745207f12" />
<br><br>
1 unziped file as you can see below!
<br><br>
I tried again:

`strings packd | grep "piilos"`
<br><br>
<img width="533" height="60" alt="Screenshot 2026-02-01 at 15 05 52" src="https://github.com/user-attachments/assets/b1aab490-8da5-4a83-9e5d-3672af54bacb" />
<br><br>
And got the answer! 
Then I tried again the answer and it worked!!
<br><br>
<img width="489" height="71" alt="Screenshot 2026-02-01 at 15 06 42" src="https://github.com/user-attachments/assets/c0c8c18f-82ca-4b66-803b-421eda3479c0" />

Sources:
- https://terokarvinen.com/application-hacking/
- https://github.com/NationalSecurityAgency/ghidra/releases/tag/Ghidra_12.0.2_build 
- https://xor.pw
- https://github.com/JayantGoel001/HackerRank/blob/master/XOR%20Strings.py
- XOR strings youtube
- https://upx.github.io
- AI Assistance: (OpenAI) was used to help understand the task requirements.







