### h5 It's alive

### a) Lab1. Investigate what's wrong with the program and how to fix it. lab1.zip

Before anything I started by updating and installing the right tools for this exersice. 

<img width="399" height="58" alt="image" src="https://github.com/user-attachments/assets/af1bd514-7e46-4c88-be97-a94fbb19c1b9" />

The I continued by installing needed tools: 

<img width="401" height="95" alt="image" src="https://github.com/user-attachments/assets/4f87313b-b151-4c50-97f8-de2cd30270eb" />

What did this command do ?

` file --> tells program type `

` strings --> shows hidden text `

` gdb --> debugger `

` ltrace --> shows library calls `

` strace --> shows system calls `

` ghidra --> graphical reverse engineering tool `

Now I have the tools I need and I can start by downloading the lab1.zip

<img width="244" height="59" alt="image" src="https://github.com/user-attachments/assets/e4ac6671-19a2-43ab-9f63-703801026861" />

<br>

<img width="337" height="128" alt="image" src="https://github.com/user-attachments/assets/05235115-e542-4a8c-a8fb-442b4b577256" />

Now let's unzip the file:

<img width="263" height="70" alt="image" src="https://github.com/user-attachments/assets/47008221-50fe-432e-9e2c-601fe7f56396" />

I tried running one of the programs:

<img width="281" height="80" alt="image" src="https://github.com/user-attachments/assets/e7173e32-9a6f-43b1-bad9-b4f45adc9ad0" />

As you can see in the picture there is ` segmentation fault`. This is the bug I must investigate and find out why it crashes.

First we are going to start by debugging: 

<img width="386" height="206" alt="image" src="https://github.com/user-attachments/assets/cb466ea7-c91f-4b6e-9cd4-0b478fe3827c" />

I run the program inside gdb:

<img width="392" height="118" alt="image" src="https://github.com/user-attachments/assets/c7923b0b-a31f-4ddf-829f-90f335a3c88c" />


As you can see it does not let me run the program, so I run ` bt (backtrace) ` to see where the crash happens.

<img width="392" height="47" alt="image" src="https://github.com/user-attachments/assets/f375793f-e697-442d-aa79-7d57103e211e" />

Here we can see where the crash happened. The problem is ` message =0x0 `. This means that the program calls ` print_scrambled () ` with a null pointer (the variable message was null) . 

How to fix the issue? By passing a valid string instead of NULL. 

<img width="319" height="11" alt="image" src="https://github.com/user-attachments/assets/3b33be58-4184-4743-8d19-b9087bf66b56" />
<br>
<img width="224" height="232" alt="image" src="https://github.com/user-attachments/assets/32c47e2b-7971-4cf9-93e4-68cd19bc4653" />
<br>
<img width="223" height="230" alt="image" src="https://github.com/user-attachments/assets/bc4dc793-44cf-4e8f-aebe-84da71e52186" />

Now I fixed the issue:

<img width="296" height="69" alt="image" src="https://github.com/user-attachments/assets/9086c948-7b15-4636-8663-10833ff73c02" />

### b) Lab2. Find out the password and flag + write a report on how it opened. lab2.zip

Just like in the previous exersice, I started by downloading thee lab2.zip and unzipped the file.

<img width="264" height="127" alt="image" src="https://github.com/user-attachments/assets/017c2291-6b9a-450f-a861-7de33c6cd0b7" />

We can see a folder ` passtr ` in the lab2:

<img width="229" height="44" alt="image" src="https://github.com/user-attachments/assets/d9961f07-6637-447b-8788-5be4b8331bc0" />

I entered the folder:

<img width="263" height="50" alt="image" src="https://github.com/user-attachments/assets/74852fae-25e4-48dc-9892-5e2bc2056c26" />

and run the program `passtr`. It asks for a password. Now I have to find the password:

<img width="288" height="55" alt="image" src="https://github.com/user-attachments/assets/0aef2a99-e5d6-42c3-8f44-88fc2e06e3f8" />

I started by looking for the passwords in the string ` strings passtr `:

<img width="386" height="85" alt="image" src="https://github.com/user-attachments/assets/87d35db3-b55d-45fc-a8d3-51c4aa30867d" />

Here we can see the password and the flag. Now lets try it:

<img width="364" height="56" alt="image" src="https://github.com/user-attachments/assets/c2341616-6ddf-4de5-9c2d-455b83d541b3" />

I analyzed the program using string command. The password was visible in the srtings. After entering the password `sala-hakkeri-321` the program revealed the flag.

### c) Lab3. Try Nora Crackmes exercises tasks 3 and 4; the rest are optional. Tindall 2023: NoraCodes / crackmes.

For this exersice, I started by downloading the `crackmes`:

<img width="379" height="50" alt="image" src="https://github.com/user-attachments/assets/c4a0967b-2881-4234-822e-7d4088b3d59c" />

We are focuing on the `crackme03` and `crackme04 `

<img width="322" height="80" alt="image" src="https://github.com/user-attachments/assets/56a76500-cd6f-4294-a84a-d48aaa7eba64" />

I started by compiling the files (turning C code into runnable program) and run it.

<img width="391" height="44" alt="image" src="https://github.com/user-attachments/assets/e32949cc-2f7d-40de-86a9-8a66404b5873" />

It asks for one argument:

<img width="305" height="35" alt="image" src="https://github.com/user-attachments/assets/b2df55bf-0343-4f17-a88e-82e92d04bca6" />

we can now see that `hey` is the incorrect password. Now lets find the real password by using strings `strings crackme03`.

<img width="176" height="109" alt="image" src="https://github.com/user-attachments/assets/18ffb440-5de1-4f9a-9513-25db000da450" />

Here we can see something! Let's try `passwordH`.

<img width="337" height="35" alt="image" src="https://github.com/user-attachments/assets/00476846-c040-4374-ae68-8382af53c3bd" />

We can see now that `passwordH ` is not the correct password.

After some digging I came acroos `ltrace` tool.

I downloaded ltrace: 

<img width="392" height="238" alt="image" src="https://github.com/user-attachments/assets/dd950ee9-3ff2-4f3b-ac71-f3b14af74e39" />

Then I run:

<img width="376" height="68" alt="image" src="https://github.com/user-attachments/assets/e5d26f00-8ed1-4b8f-b56e-94b48edbbada" />

Here I couldn't see anything that would help me so I went back to strings: 

<img width="392" height="47" alt="image" src="https://github.com/user-attachments/assets/3559072d-5c6e-4094-8657-655a1ecf6d38" />

It took me a while to understand that this means that the crackme03 does not store password as text... Should have seen it before!

I opened the crackme03 on a text editor:

Here we can see `password`, but the real password is not that because the program adds a mask. We can se the numbers above `3, 5, 2, 4 ...`. The program takes each letter from the word `password` and moves it forward in the alphabet. 
<img width="400" height="136" alt="image" src="https://github.com/user-attachments/assets/6625bdf8-0a29-4665-8151-95abd371b783" />

After moving all the alpabets forward to their right places we get: `sfuwxoue `. Now lets try this as a password.

<img width="346" height="32" alt="image" src="https://github.com/user-attachments/assets/d0080f08-029f-4483-b017-b62bd4668fcb" />


And it was the correct answer!!!

Now let's do the same with crackme04.

I opened crackme04 directly in a text editor.

In the text editor we can see this part: 

<img width="154" height="44" alt="image" src="https://github.com/user-attachments/assets/02d94c4f-c79f-444d-a334-a7a1aac03bb0" />

This means that the program does not store a password, instead it checks if it's 16 characters and when ASCII values added together it should gove 1762.
I used https://www.asciitable.com/ this table to count and find the right answer.

The possible answer could be: pnnnnnnnnnnnnnnn

p = 112
n= 110

112 * (110*15) = 1762

Now let's try it: 

<img width="376" height="37" alt="image" src="https://github.com/user-attachments/assets/2ae02c8d-8765-4f34-b180-c50fec8ad1f1" />

and it worked!!!!


### Tapo C200 Firmware investigation

In this task I will investigate the Tapo C200 Firmware, but i do not have the camera, so I will attack only the software.

I will:
1. Get firmware
2. Decrypt firmware
3. Open firmware
4. Look insidee camera systems
5. find security issues

I started by preparing my environment. I installed tools that are needed for firmware hacking.

<img width="212" height="13" alt="image" src="https://github.com/user-attachments/assets/db97e08f-4191-4c52-844a-d90eeacf8fb7" />

<br>

<img width="400" height="25" alt="image" src="https://github.com/user-attachments/assets/f8d6c703-69b9-4e09-aaa2-d039e2b0a24a" />

`git --> downloads code from GitHub`
<br>
`build-essential --> compile programs`
<br>
`binwalk --> open firmware files`
<br>
`libssl-dev --> compile decrypt tool`

Next, we need to download the camera operating system. I started by downloading AWS CLI v2:

<img width="287" height="16" alt="image" src="https://github.com/user-attachments/assets/5c7d44e4-337e-405e-b8a2-d159a76b45bb" />

<br>

<img width="398" height="58" alt="image" src="https://github.com/user-attachments/assets/ffd30f30-1364-4984-8a23-36330aefc40b" />



### Sources

https://terokarvinen.com/application-hacking/
<br>
https://blog.packagecloud.io/how-does-ltrace-work/
<br>
https://www.asciitable.com/























